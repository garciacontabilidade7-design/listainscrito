<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Inscrições</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    .btn-pdf {
      margin: 20px 0;
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
      border-radius: 5px;
    }
    .btn-pdf:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>

  <button class="btn-pdf" onclick="generatePDF()">Gerar PDF</button>

  <table id="inscricoes">
    <thead>
      <tr>
        <th>NOME COMPLETO</th>
        <th>DATA DE NASCIMENTO</th>
        <th>CPF</th>
        <th>SEU E-MAIL AQUI</th>
        <th>ESCOLHA UMA OPÇÃO</th>
        <th>ESCOLHA UM TAMANHO</th>
        <th>CAMISETAS ADULTAS</th>
        <th>ESCOLHA UMA OPÇÃO</th>
        <th>NÍVEL DE ESCOLARIDADE</th>
        <th>STATUS DA ESCOLARIDADE</th>
        <th>ÁREA DE ATUAÇÃO/FORMAÇÃO</th>
      </tr>
    </thead>
    <tbody>
      <?php
        // Conexão com Google Sheets
        $spreadsheetId = "SUA_PLANILHA_ID";
        $range = "Página1!A2:M"; // até coluna M
        $response = $service->spreadsheets_values->get($spreadsheetId, $range);
        $values = $response->getValues();

        if (!empty($values)) {
          foreach ($values as $row) {
            echo "<tr>";
            echo "<td>" . ($row[1] ?? '') . "</td>"; // Nome completo
            echo "<td>" . ($row[2] ?? '') . "</td>"; // Data nascimento
            echo "<td>" . ($row[8] ?? '') . "</td>"; // CPF
            echo "<td>" . ($row[9] ?? '') . "</td>"; // E-mail
            echo "<td>" . ($row[3] ?? '') . "</td>"; // Escolha opção
            echo "<td>" . ($row[4] ?? '') . "</td>"; // Tamanho
            echo "<td>" . ($row[5] ?? '') . "</td>"; // Camisetas
            echo "<td>" . ($row[6] ?? '') . "</td>"; // Outra opção
            echo "<td>" . ($row[7] ?? '') . "</td>"; // Nível escolaridade
            echo "<td>" . ($row[11] ?? '') . "</td>"; // Status escolaridade
            echo "<td>" . ($row[12] ?? '') . "</td>"; // Área de atuação
            echo "</tr>";
          }
        }
      ?>
    </tbody>
  </table>

  <!-- Gerar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script>
    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('l', 'pt', 'a4'); // paisagem
      doc.autoTable({ html: '#inscricoes' });
      doc.save('inscricoes.pdf');
    }
  </script>

</body>
</html>
