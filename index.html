<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Inscritos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    h1 {
      text-align: center;
      margin: 20px 0;
    }

    .contador {
      margin: 10px;
      padding: 10px 20px;
      background: #4CAF50;
      color: white;
      font-weight: bold;
      border-radius: 8px;
      display: inline-block;
    }

    .busca-container {
      margin: 10px;
      text-align: left;
    }

    .busca-container input {
      padding: 10px;
      width: 100%;
      max-width: 400px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .tabela-container {
      overflow-x: auto;
      margin: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      max-height: 70vh;
      overflow-y: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 800px;
    }

    thead th {
      position: sticky;
      top: 0;
      background: #4CAF50;
      color: white;
      padding: 10px;
      text-align: left;
      border-bottom: 2px solid #ddd;
    }

    tbody tr:nth-child(even) {
      background: #f9f9f9;
    }

    tbody td {
      padding: 8px;
      border-bottom: 1px solid #ddd;
    }

    @media (max-width: 768px) {
      .contador {
        display: block;
        text-align: center;
      }

      .busca-container {
        text-align: center;
      }

      .busca-container input {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Lista de Inscritos</h1>

  <div class="contador" id="contador">Total de inscritos: 0</div>

  <div class="busca-container">
    <input type="text" id="busca" placeholder="Buscar por nome...">
  </div>

  <div class="tabela-container">
    <table id="tabela">
      <thead>
        <tr id="cabecalho"></tr>
      </thead>
      <tbody id="corpo"></tbody>
    </table>
  </div>

  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTnvpbDC9xv14rAKgB-smE41QwHhtDzkebvybZXZJI3IPf5CgGIysavUtCNSU2Ju5NYDnru6_iGvPBJ/pub?gid=1297981915&single=true&output=csv";

    async function carregarInscritos() {
      const resposta = await fetch(CSV_URL);
      const texto = await resposta.text();

      const linhas = texto.split("\n").map(l => l.split(","));
      const cabecalhos = linhas[0];
      const dados = linhas.slice(1);

      // Ignorar colunas A, N, O (índices 0, 13, 14)
      const colunasPermitidas = cabecalhos.map((_, i) => i).filter(i => i !== 0 && i !== 13 && i !== 14);

      // Montar cabeçalho
      const cabecalhoEl = document.getElementById("cabecalho");
      cabecalhoEl.innerHTML = "";
      colunasPermitidas.forEach(i => {
        const th = document.createElement("th");
        th.textContent = cabecalhos[i];
        cabecalhoEl.appendChild(th);
      });

      const corpoEl = document.getElementById("corpo");
      corpoEl.innerHTML = "";

      dados.forEach(linha => {
        if (linha.length > 1) {
          const tr = document.createElement("tr");
          colunasPermitidas.forEach(i => {
            const td = document.createElement("td");
            td.textContent = linha[i] || "";
            tr.appendChild(td);
          });
          corpoEl.appendChild(tr);
        }
      });

      atualizarContagem();
    }

    function atualizarContagem() {
      const linhas = document.querySelectorAll("#corpo tr");
      document.getElementById("contador").textContent = "Total de inscritos: " + linhas.length;
    }

    document.getElementById("busca").addEventListener("input", function () {
      const filtro = this.value.toLowerCase();
      const linhas = document.querySelectorAll("#corpo tr");
      let contador = 0;

      linhas.forEach(linha => {
        const nome = linha.cells[0]?.textContent.toLowerCase() || "";
        if (nome.includes(filtro)) {
          linha.style.display = "";
          contador++;
        } else {
          linha.style.display = "none";
        }
      });

      document.getElementById("contador").textContent = "Total de inscritos: " + contador;
    });

    carregarInscritos();
  </script>
</body>
</html>
